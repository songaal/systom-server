<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="performance">

    <insert id="insertPerformanceSummary" parameterType="PerformanceSummary">
        INSERT INTO performance_summary
        ( invest_id, cash,       init_cash,     equity,
          returns,   returns_pct, mdd,        pnl_rate,   avg_profit,    avg_lose,
          trades,    win_count,   lose_count, commission, coin_invested, base_invested
        )
        VALUES( ${investId}
              , ${cash}
              , ${initCash}
              , ${equity}
              , ${returns}
              , ${returnsPct}
              , ${mdd}
              , ${pnlRate}
              , ${avgProfit}
              , ${avgLose}
              , ${trades}
              , ${winCount}
              , ${loseCount}
              , ${commission}
              , ${coinInvested}
              , ${baseInvested}
        )
    </insert>

    <delete id="deletePerformanceSummary" parameterType="Integer">
        DELETE FROM performance_summary
         WHERE invest_id = #{param1}
    </delete>

    <delete id="deletePerformanceDaily" parameterType="Integer">
        DELETE FROM performance_daily
         WHERE invest_id = #{param1}
    </delete>

    <select id="getPerformanceSummary" resultType="PerformanceSummary" parameterType="Integer">
        SELECT a.invest_id
             , a.cash
             , a.init_cash
             , a.equity
             , a.returns
             , a.returns_pct
             , a.mdd
             , a.pnl_rate
             , a.avg_profit
             , a.avg_lose
             , a.trades
             , a.win_count
             , a.lose_count
             , a.commission
             , a.coin_invested
             , a.base_invested
             , a.positions
             , a.update_time
          FROM performance_summary a
         WHERE a.invest_id = #{param1}
    </select>

    <select id="getPerformanceDailyList" resultType="PerformanceDaily" parameterType="Integer">
        SELECT a.invest_id
             , a.date
             , a.market_price
             , a.cash
             , a.equity
             , a.returns
             , a.returns_pct
             , a.cum_return
             , a.cum_return_pct
             , a.update_time
             , a.hwm
             , a.prev_equity
             , a.prev_hwm
          FROM performance_daily a
         WHERE a.invest_id = #{param1}
    </select>

</mapper>
